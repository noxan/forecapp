(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[337],{79666:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/prediction",function(){return a(5766)}])},95177:function(e,t,a){"use strict";var n=a(85893),i=a(34475),r=a(67294),s=a(68022),l=a(86634),o=a(3314);let d=[{title:"Overview",component:s.Z},{title:"Visualize",component:o.Z},{title:"Table",component:l.Z}];t.Z=e=>{let{modalVisible:t,setModalVisible:a}=e,[s,l]=(0,r.useState)(0),o=d[s].component;return(0,n.jsxs)(i.Tk,{fullscreen:!0,visible:t,onClose:()=>a(!1),children:[(0,n.jsxs)(i.p0,{children:[(0,n.jsx)(i.fl,{children:"Dataset explorer"}),(0,n.jsx)(i.n2,{variant:"pills",className:"mx-4",children:d.map((e,t)=>(0,n.jsx)(i.U6,{children:(0,n.jsx)(i.AQ,{href:"#",active:t===s,onClick:()=>l(t),children:e.title})},e.title))})]}),(0,n.jsx)(i.sD,{children:(0,n.jsx)(o,{})})]})}},35587:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});var n=a(85893),i=a(34475),r=a(3744);function s(){return(0,n.jsx)(i.KB,{children:(0,n.jsx)(i.rb,{className:"my-5",children:(0,n.jsx)(i.b7,{children:(0,n.jsx)(r.Z,{href:"/wizard/pick-time",children:"Start with time and prediction column selection"})})})})}},5766:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return es}});var n=a(85893),i=a(67294),r=a(66816),s=a(3654),l=a(62594),o=a(55406),d=a(63909),c=a(35587),u=a(34475),h=a(57460),m=a(95177),g=a(25675),x=a.n(g),f=e=>{let{children:t,placement:a}=e;return(0,n.jsx)(u.If,{content:t,placement:a||"right",children:(0,n.jsx)("a",{children:(0,n.jsx)(x(),{src:"/icon-info.svg",width:"30",height:"30",alt:"Help text"})})})},v=a(3744);let j={"--cui-header-min-height":"3rem","--cui-header-padding-y":"0.25rem"},p=e=>Object.keys(e).reduce((t,a)=>{let n=Object.values(e[a]);return t[a]=n.slice(-1)[0],t},{}),b=e=>{let t=p(e);return Object.keys(t).filter(e=>"epoch"!==e).map(e=>(0,n.jsxs)("span",{className:"mx-1",children:[e,": ",t[e].toFixed(2)]},e))},y=e=>{let t=Object.keys(e),a=Object.values(e[t[0]]).map((a,n)=>{let i={};return t.forEach(t=>{i[t]=e[t][n]}),i}),n=(0,h.unparse)(a),i=new Blob([n]),r=URL.createObjectURL(i),s=document.createElement("a");s.href=r,s.setAttribute("download","forecapp-export.csv"),s.click()};var w=e=>{let{metrics:t,forecastData:a,canPredict:r,apiPredictionAction:s,historyOnClick:l}=e,[o,d]=(0,i.useState)(!1);return(0,n.jsx)(u.PO,{position:"sticky",className:"mb-4",style:j,children:(0,n.jsxs)(u.KB,{fluid:!0,children:[o&&(0,n.jsx)(m.Z,{modalVisible:o,setModalVisible:d}),(0,n.jsx)(u.qy,{className:"mx-auto d-md-none",children:"Header"}),(0,n.jsx)(u.g3,{className:"d-none d-md-flex me-auto",children:(0,n.jsxs)(u.lx,{className:"d-flex",children:[(0,n.jsx)(u.u5,{variant:"outline",onClick:()=>d(!0),children:"Explore dataset"}),(0,n.jsx)(v.Z,{className:"mx-2",href:"/explainable",variant:"outline",children:"Explain forecast parameters"}),(0,n.jsx)(u.u5,{variant:"outline",onClick:()=>l(),children:"Model history"})]})}),(0,n.jsxs)(u.g3,{children:[(0,n.jsx)(u.lx,{className:"d-flex",children:(0,n.jsx)(u.u5,{onClick:s,disabled:!r,children:"Update forecast"})}),(0,n.jsx)(u.U6,{children:(0,n.jsxs)(u.AQ,{children:["Metrics: ",t?b(t):"Loading",(0,n.jsxs)(f,{placement:"bottom",children:["MAE = Mean absolute error (less is better)",(0,n.jsx)("br",{}),"RMSE = Root-mean-square deviation (less is better)"]})]})}),(0,n.jsx)(u.lx,{className:"d-flex",children:(0,n.jsx)(u.u5,{variant:"outline",color:"secondary",disabled:!a,onClick:()=>y(a),children:"Export CSV"})})]})]})})},C=e=>{let{className:t}=e;return(0,n.jsx)(u.xH,{className:t,children:(0,n.jsxs)(u.sl,{children:[(0,n.jsx)(u.tj,{children:"Getting started"}),(0,n.jsx)(u.uS,{children:"Congratulations on your forecast. The forecast is mostly automatically configured. You can further improve it by adjusting the settings below and check the metrics on the top right. Make sure to update your forecast after you make changes."})]})})},k=a(87918),D=a(91529),S=a(45268),O=a(66323),N=a(72267),z=a(50720),T=a(59382),Y=a(18645),M=a(27484),E=a.n(M),_=a(58141);let I={milliseconds:"YYYY-MM-DD hh:mm:ss.SSS a",seconds:"YYYY-MM-DD hh:mm:ss a",minutes:"YYYY-MM-DD hh:mm a",hours:"YYYY-MM-DD hh a",days:"YYYY-MM-DD",weeks:"YYYY-MM-DD",months:"YYYY-MM"},V=["years","months","weeks","days","hours","minutes","seconds","milliseconds"],W={milliseconds:1,seconds:1e3,minutes:6e4,hours:36e5,days:864e5,weeks:6048e5,months:2592e6,years:31536e6},R=(e,t)=>{let a=e.indexOf(t);return a>-1&&e.splice(a,1),e},A=(e,t)=>{if(""===t[0]||""===t[1]||"Invalid Date"===t[0]||"Invalid Date"===t[1])return e;let a=new Date(t[0]),n=new Date(t[1]);if(a>n)return e;let i=t[0]+"/"+t[1];return e.includes(i)||e.push(i),e},Z=(e,t,a)=>{let n=t.getTime()-e.getTime(),i=V.find(e=>n/W[e]>=2),r=void 0!==i?V.filter(e=>W[e]<=W[i]):V,s=r.filter(e=>W[e]>W[a]),l=["unique",...s];return l},q=(e,t,a,n,i)=>{let r;let{startDate:l,endDate:o}=(0,s.CD)(E()(e[0],n).toDate().toString(),E()(e[1],n).toDate().toString(),i),d=new Date(a[1]),c=A([],[e[0],e[1]]);if("unique"===t||(r=W[t],o.getTime()-l.getTime()>r))return c;let u=Math.floor((d.getTime()-o.getTime())/r);for(let e=1;e<=u;e++){let a="",i="";if("years"===t?(a=E()(new Date(l.getFullYear()+e,l.getMonth(),l.getDate())).format(n),i=E()(new Date(o.getFullYear()+e,o.getMonth(),o.getDate())).format(n)):"months"===t?(a=E()(new Date(l.getFullYear(),l.getMonth()+e,l.getDate())).format(n),i=E()(new Date(o.getFullYear(),o.getMonth()+e,o.getDate())).format(n)):(a=E()(new Date(l.getTime()+r*e)).format(n),i=E()(new Date(o.getTime()+r*e)).format(n)),new Date(i).getTime()>d.getTime())break;c=A(c,[a,i])}return c},F=(e,t,a,n)=>{let i=Object.values(t),r=e.split("/"),l=[],{startDate:o,endDate:d}=(0,s.CD)(E()(r[0],n).toDate().toString(),E()(r[1],n).toDate().toString(),a);for(let e=0;e<i.length;e++){let t=new Date(i[e]);t>=o&&t<=d&&l.push(i[e])}return l},L=e=>{let{eventName:t,eventDateRanges:a,regularization:n,window:i}=e,r={eventName:{valid:!1,error:""},eventDateRanges:{valid:!1,error:""},regularization:{valid:!1,error:""},lowerWindow:{valid:!1,error:""},upperWindow:{valid:!1,error:""}};return r.eventName=(0,_.D)(N.Jb.safeParse(t)),r.eventDateRanges=(0,_.D)(N.BW.safeParse(a)),r.regularization=(0,_.D)(N.t8.safeParse(n)),r.lowerWindow=(0,_.D)(N.Md.safeParse(i[0])),r.upperWindow=(0,_.D)(N.yk.safeParse(i[1])),r};var P=e=>{let{visible:t,setVisible:a,timeResolution:s,datasetTimeRange:l}=e,[d,c]=(0,i.useState)(""),[h,m]=(0,i.useState)([]),[g,x]=(0,i.useState)(["",""]),[f,v]=(0,i.useState)(!1),[j,p]=(0,i.useState)(0),[b,y]=(0,i.useState)([0,0]),w=(0,r.C)(o.dO),C=(0,r.C)(e=>e.datasets.prediction),[S,O]=(0,i.useState)(null),[N,M]=(0,i.useState)(null),[_,V]=(0,i.useState)(["unique"]),[W,A]=(0,i.useState)("unique"),P=(0,r.T)(),K=()=>{c(""),x(["",""]),m([]),p(0),y([0,0])};(0,i.useEffect)(()=>{V(Z(new Date(l[0]),new Date(l[1]),s))},[l,s]);let H=(0,i.useMemo)(()=>{switch(S){case"maxDate":case"maxTime":return"Date is after the end date of the dataset";case"minDate":case"minTime":return"Date is before the start date of the dataset";case"invalidDate":return"Date is invalid";default:return""}},[S]),B=(0,i.useMemo)(()=>{switch(N){case"maxDate":case"maxTime":return"Date is after the end date of the dataset";case"minDate":case"minTime":return"Date is before the start date of the dataset";case"invalidDate":return"Date is invalid";default:return""}},[N]),U=L({eventName:d,eventDateRanges:h,regularization:j,window:b}),G=()=>{let e=h.reduce((e,t)=>[...e,...F(t,null==C?void 0:C.forecast.ds,s,I[s])],[]),t={dates:e,regularization:j,lowerWindow:b[0],upperWindow:b[1],mode:"additive"};P((0,D.zy)({events:{[d]:t}}))};return(0,n.jsxs)(u.Tk,{className:"show d-block",backdrop:"static",visible:t,scrollable:!0,onClose:()=>{K(),a(!1)},children:[(0,n.jsx)(u.p0,{children:(0,n.jsx)(u.fl,{children:"Add a one time or recurring event with all assoicated dates"})}),(0,n.jsx)(u.sD,{children:(0,n.jsxs)("div",{className:"events-builder-modal__body",children:[(0,n.jsxs)("div",{className:"events-builder-modal__body__event-settings",children:[(0,n.jsx)("h5",{children:"Event Settings"}),(0,n.jsx)(u.jO,{type:"text",size:"sm",placeholder:"Event name",onChange:e=>c(e.target.value),valid:U.eventName.valid,invalid:!U.eventName.valid,feedbackValid:"",feedbackInvalid:U.eventName.error}),(0,n.jsx)(u.u5,{onClick:()=>v(!f),children:f?"Hide Advanced":"Show Advanced"}),(0,n.jsx)(u.V9,{visible:f,children:(0,n.jsx)(u.xH,{className:"mt-3",children:(0,n.jsxs)(u.sl,{children:[(0,n.jsx)(u.ZB,{min:0,max:1,step:.01,label:"Regularization ".concat(j),defaultValue:0,onChange:e=>p(Number(e.target.value))}),(0,n.jsxs)("p",{children:["Window Start ",s]}),(0,n.jsx)(u.jO,{type:"number",size:"sm",placeholder:"Window start ".concat(s),defaultValue:0,onChange:e=>{y([Number(e.target.value),b[1]])},valid:U.lowerWindow.valid,invalid:!U.lowerWindow.valid,feedbackValid:"",feedbackInvalid:U.lowerWindow.error}),(0,n.jsxs)("p",{children:["Window End ",s]}),(0,n.jsx)(u.jO,{type:"number",size:"sm",placeholder:"Window end ".concat(s),defaultValue:0,onChange:e=>{y([b[0],Number(e.target.value)])},valid:U.upperWindow.valid,invalid:!U.upperWindow.valid,feedbackValid:"",feedbackInvalid:U.upperWindow.error})]})})})]}),(0,n.jsxs)("div",{className:"events-builder-modal__body__dates-box",children:[(0,n.jsx)("h5",{children:"Add Date"}),(0,n.jsxs)(z._,{dateAdapter:T.y,children:[(0,n.jsx)(Y.l,{onChange:e=>null!==e?x([e.format(I[s]).toString(),g[1]]):x(["",g[1]]),maxDateTime:""===g[1]?E()(l[1]):E()(g[1],I[s]),minDateTime:E()(l[0]),format:I[s],onError:e=>O(e),slotProps:{textField:{helperText:H}}}),(0,n.jsx)(Y.l,{maxDateTime:E()(l[1]),minDateTime:""===g[0]?E()(l[0]):E()(g[0],I[s]),onChange:e=>null!==e?x([g[0],e.format(I[s]).toString()]):x([g[0],""]),format:I[s],onError:e=>M(e),slotProps:{textField:{helperText:B}}})]}),(0,n.jsxs)(u.w5,{variant:"btn-group",children:[(0,n.jsx)(u.u5,{onClick:()=>null===S&&null===N&&m([...h,...q(g,W,l,I[s],s)]),children:"Add Date Range"}),(0,n.jsx)(u.SQ,{color:"primary",split:!0,children:W}),(0,n.jsx)(u.$H,{children:_.length>0&&_.map((e,t)=>(0,n.jsx)(u.$f,{onClick:()=>A(e),children:e},t))})]}),(0,n.jsx)("div",{className:"events-builder-modal__body__dates-list",children:h.map((e,t)=>(0,n.jsx)(k.Z,{label:e,onDelete:()=>{let e=R([...h],h[t]);m(e)}},t))})]})]})}),(0,n.jsxs)(u.Ym,{children:[(0,n.jsx)(u.u5,{color:"secondary",onClick:()=>{K(),a(!1)},children:"Close"}),(0,n.jsx)(u.u5,{color:"primary",onClick:()=>{U.eventName.valid&&U.eventDateRanges.valid&&U.regularization.valid&&U.lowerWindow.valid&&U.upperWindow.valid&&void 0===w.events[d]&&(G(),a(!1))},children:"Save Changes"})]})]})};let K=e=>""===e?null:Number(e);var H=()=>{let e=(0,r.C)(o.Wb),t=Object.keys(e[0]),a=(0,r.C)(o.e_),l=(0,r.C)(o.$m),d=(0,r.C)(o.dO),c=(0,r.T)(),h=(0,N.Jk)(d),[m,g]=(0,i.useState)(!1),x=t.filter(e=>e!==a&&e!==l),v=(0,s.FV)(e,a),{startDate:j,endDate:p}=(0,i.useMemo)(()=>(0,s.zb)(e,a),[e,a]);return console.log(j,p),(0,n.jsxs)(u.uz,{activeItemKey:10,children:[(0,n.jsxs)(u.Ob,{itemKey:10,children:[(0,n.jsx)(u.Lv,{children:"Forecast horizon"}),(0,n.jsxs)(u.qI,{children:["How far should the model predict into the future? The unit is based on your dataset in ",(0,n.jsx)("b",{children:v}),".",(0,n.jsx)(u.jO,{type:"number",defaultValue:d.forecasts,placeholder:"Number of values to forecast...",onChange:e=>c((0,D.zy)({forecasts:K(e.target.value)})),valid:h.forecasts.valid,invalid:!h.forecasts.valid,feedbackValid:"",feedbackInvalid:h.forecasts.error})]})]}),(0,n.jsxs)(u.Ob,{itemKey:12,children:[(0,n.jsx)(u.Lv,{children:"Trend"}),(0,n.jsxs)(u.qI,{children:[(0,n.jsx)(u.EC,{id:"trend",label:"Enable trend",defaultChecked:"linear"===d.trend.growth,onChange:e=>c((0,D.zy)({trend:{growth:e.target.checked?"linear":"off"}}))}),"Number of changepoints"," ",(0,n.jsx)(f,{children:"Trend change points, also known as inflection points, are points in a data series where the direction of the trend changes. For example, if a data series is trending upwards and then begins to trend downwards, the point where the upward trend ends and the downward trend begins is a trend change point."}),(0,n.jsx)(u.jO,{type:"number",min:0,disabled:"off"===d.trend.growth,defaultValue:d.trend.numberOfChangepoints,onChange:e=>{c((0,D.zy)({trend:{numberOfChangepoints:Number(e.target.value)}}))},valid:"off"===d.trend.growth?void 0:h.trend.numberOfChangepoints.valid,invalid:"off"===d.trend.growth?void 0:!h.trend.numberOfChangepoints.valid,feedbackValid:"",feedbackInvalid:h.trend.numberOfChangepoints.error})]})]}),(0,n.jsxs)(u.Ob,{itemKey:14,children:[(0,n.jsx)(u.Lv,{children:"Seasonality"}),(0,n.jsxs)(u.qI,{children:[(0,n.jsx)(u.EC,{id:"seasonalityDaily",label:"Enable daily seasonality",defaultChecked:d.seasonality.daily,onChange:e=>c((0,D.zy)({seasonality:{daily:e.target.checked}}))}),(0,n.jsx)(u.EC,{id:"seasonalityWeekly",label:"Enable weekly seasonality",defaultChecked:d.seasonality.weekly,onChange:e=>c((0,D.zy)({seasonality:{weekly:e.target.checked}}))}),(0,n.jsx)(u.EC,{id:"seasonalityYearly",label:"Enable yearly seasonality",defaultChecked:d.seasonality.yearly,onChange:e=>c((0,D.zy)({seasonality:{yearly:e.target.checked}}))})]})]}),(0,n.jsxs)(u.Ob,{children:[(0,n.jsx)(u.Lv,{children:"Events"}),(0,n.jsxs)(u.qI,{children:[(0,n.jsx)("p",{children:"Specify a list of special events that may have had an effect on the time-series."}),(0,n.jsx)(u.u5,{onClick:()=>g(!0),children:"Add a recurring event"}),(0,n.jsx)("div",{className:"events-item__events-list",children:Object.keys(d.events).map(e=>(0,n.jsx)(k.Z,{label:e,onDelete:()=>c((0,D.xC)({eventKey:e}))},e))}),(0,n.jsx)(P,{visible:m,setVisible:g,timeResolution:v,datasetTimeRange:[j,p]})]})]}),(0,n.jsxs)(u.Ob,{itemKey:20,children:[(0,n.jsx)(u.Lv,{children:"Auto regression"}),(0,n.jsxs)(u.qI,{children:["How many previous values should be used to predict the next value?",(0,n.jsx)(f,{children:"Autoregression uses previous values of a time-series to predict the value of the next time point. It is based on the assumption that the past values of a time-series are related to the future values in a linear way. The optimal value for an autoregressive model is determined by the complexity of the relationship between the past and future values in the time-series data. A larger value may capture more of this complexity, but it may also increase the risk of overfitting, where the model fits the training data too closely and may not generalize well to new data. On the other hand, a smaller value may not capture enough complexity and may result in a model with lower accuracy."}),(0,n.jsx)(u.jO,{className:"mb-4",type:"number",placeholder:"Number of lags",min:0,defaultValue:d.autoregression.lags,onChange:e=>c((0,D.zy)({autoregression:{lags:K(e.target.value)}})),valid:h.autoregression.lags.valid,invalid:!h.autoregression.lags.valid,feedbackValid:"",feedbackInvalid:h.autoregression.lags.error}),(0,n.jsx)(u.ZB,{min:0,max:1,step:.01,label:"Regularization (".concat(d.autoregression.regularization,")"),defaultValue:d.autoregression.regularization,onChange:e=>c((0,D.zy)({autoregression:{regularization:Number(e.target.value)}}))})]})]}),(0,n.jsxs)(u.Ob,{itemKey:50,children:[(0,n.jsx)(u.Lv,{children:"Holidays"}),(0,n.jsxs)(u.qI,{children:["Which country specific holidays should be considered?",(0,n.jsx)(S.Z,{modelConfiguration:d,updateConfig:e=>c((0,D.zy)(e))})]})]}),(0,n.jsxs)(u.Ob,{itemKey:55,children:[(0,n.jsx)(u.Lv,{children:"Regressors"}),(0,n.jsxs)(u.qI,{children:["Are there any variables or values which have an influence on our prediction? (e.g. weather forecast for solar power production)",(0,n.jsx)(O.Z,{laggedRegressorColumns:x,modelConfiguration:d,updateConfig:e=>c((0,D.zy)(e))})]})]}),(0,n.jsxs)(u.Ob,{itemKey:60,children:[(0,n.jsx)(u.Lv,{children:"Training"}),(0,n.jsxs)(u.qI,{children:["How many epochs to train?",(0,n.jsx)(u.jO,{type:"number",placeholder:"auto",min:1,defaultValue:d.training.epochs,onChange:e=>c((0,D.zy)({training:{epochs:K(e.target.value)}})),valid:null!==d.training.epochs?h.training.epochs.valid:void 0,invalid:null!==d.training.epochs?!h.training.epochs.valid:void 0,feedbackValid:"",feedbackInvalid:h.training.epochs.error}),(0,n.jsx)(u.EC,{id:"earlyStopping",label:"Stop training early if no improvement is seen",defaultChecked:d.training.earlyStopping,onChange:e=>c((0,D.zy)({training:{earlyStopping:e.target.checked}}))}),(0,n.jsx)("h5",{className:"mt-3",children:"Advanced options"}),"Learning rate",(0,n.jsx)(u.jO,{type:"number",placeholder:"auto",defaultValue:d.training.learningRate,onChange:e=>c((0,D.zy)({training:{learningRate:K(e.target.value)}})),valid:null!==d.training.learningRate?h.training.learningRate.valid:void 0,invalid:null!==d.training.learningRate?!h.training.learningRate.valid:void 0,feedbackValid:"",feedbackInvalid:h.training.learningRate.error}),"Batch size",(0,n.jsx)(u.jO,{type:"number",placeholder:"auto",defaultValue:d.training.batchSize,onChange:e=>c((0,D.zy)({training:{batchSize:K(e.target.value)}})),valid:null!==d.training.batchSize?h.training.batchSize.valid:void 0,invalid:null!==d.training.batchSize?!h.training.batchSize.valid:void 0,feedbackValid:"",feedbackInvalid:h.training.batchSize.error})]})]})]})},B=a(36994),U=a(27525),G=e=>(0,n.jsxs)("div",{style:{position:"absolute",zIndex:100,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",backgroundColor:"rgba(255, 255, 255, 0.5)",height:"100vh"},children:[(0,n.jsx)(u.LQ,{color:"primary"}),(0,n.jsx)("p",{children:e.msg})]}),Q=()=>(0,n.jsxs)("div",{style:{display:"flex",height:"100vh",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[(0,n.jsx)(u.LQ,{color:"primary"}),(0,n.jsx)("p",{className:"pt-2",children:"Generating your first forecast..."})]}),$=a(11163),J=a(1604),X=a(41248),ee=a(2980);let et=e=>Object.keys(e).reduce((t,a)=>{let n=Object.values(e[a]);return t[a]=n.slice(-1)[0],t},{}),ea=e=>{let t=et(e);return Object.keys(t).filter(e=>"epoch"!==e).map(e=>(0,n.jsxs)("span",{className:"mx-1",children:[e,": ",t[e].toFixed(2)]},e))},en=e=>{let t=(0,X.I0)(),a=(0,r.C)(o.dR)(e.index),i=e.index===(0,r.C)(o.MS);return(0,n.jsx)(u.Eb,{active:i,children:(0,n.jsxs)(u.rb,{children:[(0,n.jsx)(u.b7,{sm:3,children:new Date(a.time).toUTCString()}),(0,n.jsxs)(u.b7,{children:["Metrics: ",ea(a.metrics)]}),(0,n.jsx)(u.b7,{children:(0,n.jsx)(u.u5,{color:"danger",onClick:()=>{confirm("This will delete this model!")&&t((0,ee.gw)(e.index))},children:"Delete"})}),(0,n.jsx)(u.b7,{children:(0,n.jsx)(u.u5,{color:"primary",onClick:()=>{t((0,ee.F9)(e.index)),t((0,D.iC)(a)),e.onClick()},children:"Apply"})})]})},e.index)};function ei(e){let t=(0,r.C)(o.TD),a=[];for(let i=0;i<t;i++)a.push((0,n.jsx)(en,{index:i,onClick:e.closeSelf},i));return(0,n.jsx)(u.GZ,{className:"model-history",children:a})}var er=a(53525);function es(){var e;let t=(0,$.useRouter)(),a=(0,r.T)(),h=(0,r.C)(o.Wb),m=(0,r.C)(o.mW),g=(0,r.C)(o.dO),x=(0,r.C)(e=>e.datasets.columns),f=(0,r.C)(o.e_),v=(0,r.C)(o.$m),j=(0,r.C)(e=>e.datasets.prediction),[p,b]=(0,i.useState)(!1),[y,k]=(0,i.useState)(),D=async()=>{try{N.Gw.parse(g),await a((0,B.uu)({dataset:(0,s.Of)(h,g,x),configuration:g})).unwrap()}catch(e){e instanceof J.jm?k((0,er.p)("The model configuration was invalid.")):e.message?k((0,er.p)("Something went wrong: "+e.message)):e.detail?e.detail instanceof Array?k((0,er.p)("The model configuration was invalid.")):k((0,er.p)("Neural Prophet failed: "+e.detail)):k((0,er.p)("An unknown error occured."))}},S=Object.keys(t.query).includes("first-run");return((0,i.useEffect)(()=>{S&&(t.replace({query:{}}),D())},[]),h)?(0,d.Zj)(f,v)?S?(0,n.jsx)(Q,{}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(w,{metrics:null==j?void 0:j.metrics,forecastData:null==j?void 0:j.forecast,apiPredictionAction:D,canPredict:!p,historyOnClick:()=>b(!p)}),(0,n.jsxs)(u.KB,{fluid:!0,children:[p?(0,n.jsx)(ei,{closeSelf:()=>{b(!1),D()}}):(0,n.jsxs)(u.rb,{children:[(0,n.jsxs)(u.b7,{sm:3,children:[(0,n.jsx)(C,{className:"mb-2"}),(0,n.jsx)(H,{})]}),(0,n.jsxs)(u.b7,{style:{position:"relative"},children:["loading"===m&&(0,n.jsx)(G,{msg:"Generating your forecast..."}),j&&"ok"===j.status&&(0,n.jsx)(U.D6,{targetColumn:v,forecast:j.forecast,numForecasts:null==j?void 0:null===(e=j.configuration)||void 0===e?void 0:e.forecasts,showUncertainty:!0,showEvents:!0,showTrend:!1,confidenceLevel:20})]})]}),(0,n.jsx)(u.KF,{push:y,placement:"bottom-end"})]})]}):(0,n.jsx)(c.Z,{}):(0,n.jsx)(l.Z,{})}}},function(e){e.O(0,[645,22,553,664,195,324,854,879,613,774,888,179],function(){return e(e.s=79666)}),_N_E=e.O()}]);